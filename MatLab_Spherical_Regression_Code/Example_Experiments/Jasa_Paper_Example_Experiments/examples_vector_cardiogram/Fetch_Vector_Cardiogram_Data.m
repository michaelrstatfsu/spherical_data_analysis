%% Vector Cardiogram Data
% This dataset come from Downs, Liebman and Mackay (1971) and can be found 
% at:
% 
% http://www.mcs.st-and.ac.uk/~pej/vcg.html
% 
% This data is very well characterized with a rigid rotation. See the link
% for the details. The basics are as follows. The vectorcardiogram is
% contructed through multiple electrocardiogram leads which are 
% placed on the body. They
% measure the electromagnetic field which are generated by heart actions.
% By placing multiple leads, one is able to triangulate the direction and
% magnitude of these electrical fields. If you where to plot these vectors
% over time, what would emerge is a cardiod-like shape. The direction of
% greatest magnitude is a relevent feature which is extract and
% has applications is disease
% diagnostics. This data set consists of measurements of children from two
% different lead systems. The correspondences between these two lead
% systems is of interest for a variety of reasons.
%
% In Downs 2003, an model was proposed using mobius transformation so
% that scaling of variables could be characterized.


%% Run this script to fetch the .xls data
% you can either run this scipt to fetch the .xls data, or you can manually
% download into this directory.
if ~exist('vcg.xls','file')
    display('Downloading vcg.xls (internet connection required)')
    URL='http://www.mcs.st-and.ac.uk/~pej/vcg.xls';filename='vcg.xls';
    urlwrite(URL,filename);
    display('Done')
end
%% Import the Raw data into Matlab ans save the mat file
% once you have the vcg.xls file import it and export it in matlab mat file
% for future use.
[~, ~, raw] = xlsread('vcg.xls','Sheet1');
raw = raw(2:end,:);
data = reshape([raw{:}],size(raw));
ID = data(:,1);
AgeSex = data(:,2);
FQRS1 = data(:,3);
FQRS2 = data(:,4);
FQRS3 = data(:,5);
FPRP1 = data(:,6);
FPRP2 = data(:,7);
FPRP3 = data(:,8);
FT1 = data(:,9);
FT2 = data(:,10);
FT3 = data(:,11);
MQRS1 = data(:,12);
MQRS2 = data(:,13);
MQRS3 = data(:,14);
MPRP1 = data(:,15);
MPRP2 = data(:,16);
MPRP3 = data(:,17);
MT1 = data(:,18);
MT2 = data(:,19);
MT3 = data(:,20);
clearvars data raw;
save rawvectorcardiogram

%% Next we will construct the individual data sets from the rawvectorcardiogram data
%%
clear;load rawvectorcardiogram.mat
group=AgeSex==1;filename='boys_2_10';% boys_2_10 n=28
Construct_mat_files
%%
clear;load rawvectorcardiogram.mat
group=AgeSex==2;filename='boys_11_19';% boys_11_19 n=28
Construct_mat_files
%%
clear;load rawvectorcardiogram.mat
group=AgeSex==3;filename='girls_2_10';% girls_2_10 n=17
Construct_mat_files
%%
clear;load rawvectorcardiogram.mat
group=AgeSex==4;filename='girls_11_19';% girls_11_19 n=25
Construct_mat_files
%%
clear;load rawvectorcardiogram.mat
group=(AgeSex==1)|(AgeSex==2);filename='boys_2_19';% boys_2_19 n=56
Construct_mat_files
%%
clear;load rawvectorcardiogram.mat
group=(AgeSex==3)|(AgeSex==4);filename='girls_2_19';% girls_2_19 n=42
Construct_mat_files
%%
clear;load rawvectorcardiogram.mat
group=(AgeSex==1)|(AgeSex==3);filename='Age_2_10';% Age_2_10 n=45
Construct_mat_files
%%
clear;load rawvectorcardiogram.mat
group=(AgeSex==2)|(AgeSex==4);filename='Age_11_19';% Age_11_19 n=53
Construct_mat_files
%%
clear;load rawvectorcardiogram.mat
group=logical(ones(1,98));filename='All';% All n=98
Construct_mat_files